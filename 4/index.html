<!doctype html>
<html lang="en" rel="preload">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Project 0</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      padding: 2rem;
      font-family: 'Inter', sans-serif;
      background: #fafafa;
      color: #111;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2.5rem;
    }
    h1.section-title {
      font-size: 1.8rem;
      font-weight: 600;
      margin-bottom: 1rem;
      text-align: center;
    }
    .row {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      width: 100%;
      max-width: 1500px;
    }
    .row.small {
      gap: 2.5rem;
    }
    .row.large {
      gap: 1rem;
    }
    .row.small img {
      max-width: 240px;
      width: 100%;
      border-radius: 8px;
    }
    .row.large img {
      max-width: 500px;
      border-radius: 8px;
    }
    .row.huge img {
      max-width: 700px;
      border-radius: 8px;
    }
    .gif {
      width: 600px;
      height: auto;
      border-radius: 12px;
    }
    .section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }
    figure {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
    }
    figcaption {
      font-size: 0.9rem;
      color: #555;
      margin-top: 0.5rem;
      text-align: center;
      font-style: italic;
    }
  </style>
</head>
<body>
  <h1>Project 3: Autostitching and Mosaics</h1>
    <div class="section">
    <h1 class="section-title">1.1 - 1.2: Shoot the Pictures -> Recover Homographies</h1>
    <div>
        The goal of the first portion of this project is to utilize homographies between images to produce interesting effects.
        A homography is a transformation that maps one plane to another, preserving straight lines. 
        Any two images on the same plane can be related by a homography, which is written as a 3x3 matrix.
    </div>
    <div>
        Essentially, we want to compute the matrix that projects points from one image onto the corresponding locations of those points on another image (assuming overlapping images).
        We solve for the entries of the 3x3 matrix (holding one constant -> 8 unknowns) using least-squares. 
        We cleverly construct a system of equations using our point correspondences below.
    </div>
    <div class="row large">
      <figure>
        <img src="images/homography_computation.png" width=400px>
        <figcaption>computeH(im1, hm2)</figcaption>
      </figure>
    </div>
    <div>
      H is the homography matrix and we can write a system equations using pairs ([x, y, 1], [x', y', 1]) (homogeneous coordinates).
    </div>

    <div>Below, we visualize two pairs of images and the point correspondences between each pair.</div>
      <div class="row huge">
      <figure>
        <img src="images/correspondences.png">
        <figcaption>Point correspondences between two images</figcaption>
      </figure>
    </div>
    <div class="row large">
      <figure>
        <img src="images/image.png">
        <figcaption>Corresponding homography matrix</figcaption>
      </figure>
    </div>

    <div>We can visualize correspondences for horizontal as well as vertical transformations.</div>

    <div class="row huge">
      <figure>
        <img src="images/correspondences_2.png">
        <figcaption>Point correspondences between two images</figcaption>
      </figure>
    </div>
          <div class="row large">
      <figure>
        <img src="images/matrix.png">
        <figcaption>Corresponding homography matrix</figcaption>
      </figure>
    </div>

    </div>

    <div class="section">
    <h1 class="section-title">1.3: Rectification</h1>
    <div>
      We can also use homographies to rectify a single image onto another plane. 
      For example, we can use a homography to project an image of a painting from a slanted angle to a plane where the painting is straight.
      We do this by computing the homography between the points of the particular object we want to rectify and the points of some rectangle or square we want to warp it into.
    </div>
    <div>
    </div>
      <div class="row small">
      <figure>
        <img src="images/stacks.jpg">
        <figcaption>Mainstacks Poster</figcaption>
      </figure>
      <figure>
        <img src="images/stacks_warped_nn.png">
        <figcaption>Rectified with Nearest Neighbors</figcaption>
      </figure>
      <figure>
        <img src="images/stacks_warped_bilinear.png">
        <figcaption>Rectified with Bilinear</figcaption>
      </figure>
    </div>

    <div>
      Warping works by projecting points from one image into their corresponding locations in the other image.
      However, one critical issue is that by passing points through the homography matrix, we are making them into floats -- i.e. they usually do not correspond to any particular pixel.
      Thus, we must find some way to interpolate the value of the projected point.
    </div>

    <div class="row small">
      <figure>
        <img src="images/ortho.jpg">
        <figcaption>Mainstacks Book</figcaption>
      </figure>
      <figure>
        <img src="images/ortho_warped_nn_full.png">
        <figcaption>Rectified with Nearest Neighbors (full image)</figcaption>
      </figure>
      <figure>
        <img src="images/ortho_warped_nn.png">
        <figcaption>Rectified with Nearest Neighbors (zoomed)</figcaption>
      </figure>
      <figure> 
        <img src="images/ortho_warped_bilinear.png">
        <figcaption>Rectified with Bilinear (zoomed)</figcaption>
      </figure>
    </div>

        <div>We explore two methods of interpolation: nearest neighbors and bilinear interpolation.
      Nearest neighbors works by picking the color value of the nearest pixel to our projected point in the original image.
      Bilinear interpolation works by taking a weighted average of the color values of the four pixels the projected point lines between.
      In practice, nearest neighbors results in more jagged results, due to rounding, and bilinear interpolation results in smoother, more visually pleasing results.
    </div>

    </div>
    
    <div class="section">
      <h1>1.4: Mosaic</h1>
      <div>
        We can also use homographies to generate some beautiful mosaics.
        We do this by warping one image into the plane of another, and then overlapping them and blending them together.
      </div>
      <div class="row large">
              <figure>
        <img src="images/IMG_3549.jpg">
        <figcaption>Purple House Left</figcaption>
      </figure>
      <figure>
        <img src="images/IMG_3547.jpg">
        <figcaption>Purple House Center</figcaption>
      </figure>
      </div>

      <div>
        In particular, I used a distance transform to achieve smooth blending between the two overlapping images.
        Distance transforms have values in the range [0, 1] and assign increasingly greater values to non-zero pixels further away from pixels with value 0.
        Thus, pixels closer to the border of an image will be more faint.
      </div>

      <div class="row huge">
      <figure>
        <img src="images/purple_house_left_center.png">
        <figcaption>Purple House Mosaic</figcaption>
      </figure>
    </div>

      <div>
        Given two distance transforms masks (for the two images), I created a mask that divided the values of the first two masks by their sum.
        Thus, wherever there was no overlap, our masked result would just return the original pixel.
        If there was an overlap, the two pixels from the two images would be blended such that the pixel closer to its image's border would have a weaker effect than the pixel farther away from its image's border.
      </div>

          <div class="row large">
              <figure>
        <img src="images/blue_house1.jpg">
        <figcaption>Blue House Lower</figcaption>
      </figure>
      <figure>
        <img src="images/blue_house2.jpg">
        <figcaption>Blue House Upper</figcaption>
      </figure>
      </div>

      <div class="row huge">
      <figure>
        <img src="images/blue_house_cropped.png">
        <figcaption>Blue House Mosaic (Cropped)</figcaption>
      </figure>
    </div>

      <div class="row large">
        <figure>
        <img src="images/IMG_3625.jpg">
        <figcaption>Stacks Lower</figcaption>
      </figure>
      <figure>
        <img src="images/IMG_3626.jpg">
        <figcaption>Stacks Upper</figcaption>
      </figure>
      </div>

      <div class="row huge">
      <figure>
        <img src="images/stacky.png">
        <figcaption>Stacks Mosaic</figcaption>
      </figure>
    </div>
    </div>


    </div>
  </div>
</body>
</html>
